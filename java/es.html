<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES | 我的博客</title>
    <meta name="description" content="德智体美劳全面发展">
    <meta name="generator" content="VitePress v2.0.0-alpha.12">
    <link rel="preload stylesheet" href="/assets/style.CZvPc2EJ.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.BpYmOEW8.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.DX8_KG1g.js">
    <link rel="modulepreload" href="/assets/chunks/framework.kZi0S3Z0.js">
    <link rel="modulepreload" href="/assets/java_es.md.CbGsdVa3.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-9f75dce3><div class="VPNavBar" data-v-9f75dce3 data-v-2a96a3d0><div class="wrapper" data-v-2a96a3d0><div class="container" data-v-2a96a3d0><div class="title" data-v-2a96a3d0><div class="VPNavBarTitle has-sidebar" data-v-2a96a3d0 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>我的博客</span><!--[--><!--]--></a></div></div><div class="content" data-v-2a96a3d0><div class="content-body" data-v-2a96a3d0><!--[--><!--]--><div class="VPNavBarSearch search" data-v-2a96a3d0><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-2a96a3d0 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/admin/my.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>关于</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/utils/index.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>潘多拉</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/java/index.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Java</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/linux/index.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Linux</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>组件</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/dev/mysql.html" data-v-cd834e02><!--[--><span data-v-cd834e02>MySql</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/dev/nginx.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Nginx</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/dev/redis.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Redis</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/dev/docker.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Docker</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-2a96a3d0 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-2a96a3d0 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-2a96a3d0 data-v-bb2aa2f0 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-2a96a3d0 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-2a96a3d0><div class="divider-line" data-v-2a96a3d0></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-8acdfeb5><div class="container" data-v-8acdfeb5><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-8acdfeb5><span class="vpi-align-left menu-icon" data-v-8acdfeb5></span><span class="menu-text" data-v-8acdfeb5>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-8acdfeb5 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-e7c6e512><div class="curtain" data-v-e7c6e512></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-e7c6e512><span class="visually-hidden" id="sidebar-aria-label" data-v-e7c6e512> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 collapsible has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>概览</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/java.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Java基础</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/openSource.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>开源框架</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/mp.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>MybatisPlus</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/springCloud.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>SpringCloud</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/webSocket.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>WebSocket</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/springCache.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>SpringCache</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/bitmap.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>位图</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/spring.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Spring</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/mqtt.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>MQTT</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/springTask.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>SpringTask</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/es.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>ES</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/dt.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>分布式事务</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/project.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Java项目</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/mq.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>MQ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/java/mybatis.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Mybatis</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-aff0b8d7><div class="VPDoc has-sidebar has-aside" data-v-aff0b8d7 data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>页面导航</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-2d0bdf9b><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _java_es" data-v-7011f0d8><div><h1 id="es" tabindex="-1">ES <a class="header-anchor" href="#es" aria-label="Permalink to “ES”">​</a></h1><blockquote><p>Elasticsearch 倒排索引、Logstash</p></blockquote><h2 id="es-1" tabindex="-1">ES <a class="header-anchor" href="#es-1" aria-label="Permalink to “ES”">​</a></h2><p>ES就类似数据库，用于存储海量数据</p><h3 id="问题-为什么es能快速查找数据" tabindex="-1">问题：为什么ES能快速查找数据？ <a class="header-anchor" href="#问题-为什么es能快速查找数据" aria-label="Permalink to “问题：为什么ES能快速查找数据？”">​</a></h3><p>ES用来倒排索引来存储文档！</p><p>ES刚开始得到数据后会根据搜索的关键字创建出一个词条和文档</p><p>查询的时候会根据词条作为索引关键字，倒排索引主要有两个组件构成，词条和文档</p><p>词条列表记录了每个文档中包含哪些单词</p><p>文档列出了所有在文档集合中出现过的单词所对应的id</p><p>正常 MySQL是这样存储的：要是查找的时候会根据索引id一个一个找，假如有100w条数据，我只查询小米手机，如果只有索引1有小米手机的话，MySQL也会把所有的索引找一遍，非常浪费时间</p><table tabindex="0"><thead><tr><th>id</th><th>名字</th><th>价格</th></tr></thead><tbody><tr><td>1</td><td>小米手机</td><td>3000</td></tr><tr><td>2</td><td>华为手机</td><td>4000</td></tr><tr><td>3</td><td>苹果</td><td>5000</td></tr></tbody></table><p>ES会根据数据库以json格式另外存在一个文档里，查找的时候只需要根据词条查找，然后通过各自对应id的并集查到想要的数据</p><table tabindex="0"><thead><tr><th>词条(term)</th><th>文档（id）</th></tr></thead><tbody><tr><td>小米</td><td>1</td></tr><tr><td>手机</td><td>1,2</td></tr><tr><td>华为</td><td>2</td></tr><tr><td>苹果</td><td>3</td></tr></tbody></table><p><img src="/assets/58.WPGww_Q5.png" alt=""></p><h3 id="比喻" tabindex="-1">比喻： <a class="header-anchor" href="#比喻" aria-label="Permalink to “比喻：”">​</a></h3><p>可以比作是去图书馆找一本书，如果你要找一本SpringBoot的书和MySQL的书，去了书店找了半天，最后发现没有，体验肯定很差。</p><p>所以我们可以把书都分类，以单词名字开头来找，比如s开头的书都放一起，然后你就可以快速找到有没有这本书！</p><h3 id="问题-存在哪里-用什么存" tabindex="-1">问题：存在哪里？用什么存？ <a class="header-anchor" href="#问题-存在哪里-用什么存" aria-label="Permalink to “问题：存在哪里？用什么存？”">​</a></h3><p>ElasticSearch就相当于MySQL数据库。我们也需要有个图形工具来操作，这个工具叫Kibana</p><p>下载好镜像后，我们放在容器中执行，首先要让es和kibana容器互联。这里先创建一个网络：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>docker network create es-net</span></span></code></pre></div><p>运行docker命令：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>docker run -d \</span></span>
<span class="line"><span>	--name es \</span></span>
<span class="line"><span>    -e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; \</span></span>
<span class="line"><span>    -e &quot;discovery.type=single-node&quot; \</span></span>
<span class="line"><span>    -v es-data:/usr/share/elasticsearch/data \</span></span>
<span class="line"><span>    -v es-plugins:/usr/share/elasticsearch/plugins \</span></span>
<span class="line"><span>    --privileged \</span></span>
<span class="line"><span>    --network es-net \</span></span>
<span class="line"><span>    -p 9200:9200 \</span></span>
<span class="line"><span>    -p 9300:9300 \</span></span>
<span class="line"><span>elasticsearch:7.12.1</span></span></code></pre></div><p>之后在浏览器中输入：<a href="http://localhost:9200" target="_blank" rel="noreferrer">http://localhost:9200</a> 即可看到elasticsearch的响应结果： 下载好可视化界面Kibana后，加载镜像：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>docker run -d \</span></span>
<span class="line"><span>--name kibana \</span></span>
<span class="line"><span>-e ELASTICSEARCH_HOSTS=http://es:9200 \</span></span>
<span class="line"><span>--network=es-net \  </span></span>
<span class="line"><span>-p 5601:5601  \</span></span>
<span class="line"><span>kibana:7.12.1</span></span></code></pre></div><p>Kibana启动比较慢，我们稍等一会，可以查看运行日志：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>docker logs -f kibana</span></span></code></pre></div><h3 id="问题-词条可以自己设定都有哪些词吗" tabindex="-1">问题：词条可以自己设定都有哪些词吗？ <a class="header-anchor" href="#问题-词条可以自己设定都有哪些词吗" aria-label="Permalink to “问题：词条可以自己设定都有哪些词吗？”">​</a></h3><p>可以安装IK分词器，分词器有两种模式 同时如果我们要新创建词语的话，也可以在IKAnalyzer.cfg.xml配置文件内容中修改添加</p><ul><li>ik_smart：最少切分</li><li>ik_max_word：最细切分</li></ul><h3 id="什么是索引库-什么是文档" tabindex="-1">什么是索引库？什么是文档？ <a class="header-anchor" href="#什么是索引库-什么是文档" aria-label="Permalink to “什么是索引库？什么是文档？”">​</a></h3><p>索引库就相当于mysql里面的一张表，文档就是存储的一行一行的数据，只不过是按照json格式存储的 <img src="/assets/59.Cc1bGIeE.png" alt=""> 添加索引库：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>PUT /heima</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;mappings&quot;: {</span></span>
<span class="line"><span>    &quot;properties&quot;: {</span></span>
<span class="line"><span>      &quot;info&quot;:{</span></span>
<span class="line"><span>        &quot;type&quot;: &quot;text&quot;,</span></span>
<span class="line"><span>        &quot;analyzer&quot;: &quot;ik_smart&quot;</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      &quot;email&quot;:{</span></span>
<span class="line"><span>        &quot;type&quot;: &quot;keyword&quot;,</span></span>
<span class="line"><span>        &quot;index&quot;: false</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      &quot;name&quot;:{</span></span>
<span class="line"><span>        &quot;properties&quot;: {</span></span>
<span class="line"><span>          &quot;firstName&quot;:{</span></span>
<span class="line"><span>            &quot;type&quot;:&quot;keyword&quot;</span></span>
<span class="line"><span>          },</span></span>
<span class="line"><span>          &quot;lastName&quot;:{</span></span>
<span class="line"><span>            &quot;type&quot;:&quot;keyword&quot;</span></span>
<span class="line"><span>          }</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>查看索引库： get /索引库名</p><p>修改索引库：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>PUT /索引库名/_mapping</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;properties&quot;: {</span></span>
<span class="line"><span>    &quot;新字段名&quot;:{</span></span>
<span class="line"><span>      &quot;type&quot;: &quot;integer&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>删除索引库：DELETE /索引库名</p><p>新增文档：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>POST /索引库名/_doc/文档id</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    &quot;字段1&quot;: &quot;值1&quot;,</span></span>
<span class="line"><span>    &quot;字段2&quot;: &quot;值2&quot;,</span></span>
<span class="line"><span>    &quot;字段3&quot;: {</span></span>
<span class="line"><span>        &quot;子属性1&quot;: &quot;值3&quot;,</span></span>
<span class="line"><span>        &quot;子属性2&quot;: &quot;值4&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>查看文档： GET /索引库名称/_doc/文档id</p><p>修改文档： 修改文档就是把原来的覆盖掉，重新建一个，如果没有对应的id，就和新增一样了，会新建一个</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>PUT /索引库名/_doc/文档id</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    &quot;字段1&quot;: &quot;值1&quot;,</span></span>
<span class="line"><span>    &quot;字段2&quot;: &quot;值2&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>修改部分字段：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>POST /索引库名/_update/文档id</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    &quot;doc&quot;: {</span></span>
<span class="line"><span>         &quot;字段名&quot;: &quot;新的值&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>删除文档： DELETE /索引库名/_doc/id值</p><h3 id="问题-在java中怎么操作" tabindex="-1">问题：在java中怎么操作？ <a class="header-anchor" href="#问题-在java中怎么操作" aria-label="Permalink to “问题：在java中怎么操作？”">​</a></h3><p>导入ES的依赖</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>&lt;dependency&gt;</span></span>
<span class="line"><span>    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;</span></span>
<span class="line"><span>    &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;</span></span>
<span class="line"><span>&lt;/dependency&gt;</span></span></code></pre></div><p>因为SpringBoot默认的ES版本是7.6.2，所以我们需要覆盖默认的ES版本：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>&lt;properties&gt;</span></span>
<span class="line"><span>    &lt;java.version&gt;11&lt;/java.version&gt;</span></span>
<span class="line"><span>    &lt;elasticsearch.version&gt;7.12.1&lt;/elasticsearch.version&gt;</span></span>
<span class="line"><span>&lt;/properties&gt;</span></span></code></pre></div><p>连接ES：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 方式一  自己拼路径</span></span>
<span class="line"><span>RestHighLevelClient client = new RestHighLevelClient(</span></span>
<span class="line"><span>    RestClient.builder(HttpHost.create(&quot;http://192.168.200.130:9200&quot;))</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 方式二   连接ip地址     端口     协议</span></span>
<span class="line"><span>RestHighLevelClient client = new RestHighLevelClient(</span></span>
<span class="line"><span>        RestClient.builder(new HttpHost(&quot;192.168.200.130&quot;, 9200, &quot;http&quot;))</span></span>
<span class="line"><span>);</span></span></code></pre></div><p>关闭ES：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>client.close();</span></span></code></pre></div><h3 id="问题-每次创建文档都要来连接一次-有简单的方法吗" tabindex="-1">问题： 每次创建文档都要来连接一次，有简单的方法吗？ <a class="header-anchor" href="#问题-每次创建文档都要来连接一次-有简单的方法吗" aria-label="Permalink to “问题： 每次创建文档都要来连接一次，有简单的方法吗？”">​</a></h3><p>我们可以把它抽取出来</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>private RestHighLevelClient client;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>@BeforeEach //方法执行之前先执行</span></span>
<span class="line"><span>void initClient() {  // 连接ES</span></span>
<span class="line"><span>    client = new   RestHighLevelClient(RestClient.builder(HttpHost.create(&quot;http://192.168.200.130:9200&quot;)));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>@AfterEach// 方法执行之后执行</span></span>
<span class="line"><span>void closeClient() throws IOException {</span></span>
<span class="line"><span>    client.close(); //关闭ES</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="问题-连接好了-接下来怎么创建索引库呢" tabindex="-1">问题：连接好了，接下来怎么创建索引库呢？ <a class="header-anchor" href="#问题-连接好了-接下来怎么创建索引库呢" aria-label="Permalink to “问题：连接好了，接下来怎么创建索引库呢？”">​</a></h3><p><img src="/assets/60.D24999t3.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>//创建一个请求  括号里的是索引库名称，不用加/ ，会自动识别</span></span>
<span class="line"><span>CreateIndexRequest request = new CreateIndexRequest(&quot;你要创建的索引库的名称&quot;);</span></span>
<span class="line"><span>//准备DSL    括号里的是请求参数，因为已经定义了常量，所以这里直接用  后面是指定什么数据类型</span></span>
<span class="line"><span>CreateIndexRequest source = request.source(HotelConstants.MAPPING_TEMPLATE, XContentType.JSON);</span></span>
<span class="line"><span>//发送请求</span></span>
<span class="line"><span>client.indices().create(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h3 id="问题-怎么判断索引库是否存在" tabindex="-1">问题：怎么判断索引库是否存在？ <a class="header-anchor" href="#问题-怎么判断索引库是否存在" aria-label="Permalink to “问题：怎么判断索引库是否存在？”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 1.创建Request对象发送请求</span></span>
<span class="line"><span>GetIndexRequest request = new GetIndexRequest(&quot;这里输入索引库的名称&quot;);</span></span>
<span class="line"><span>// 2.发送请求，检查指定的索引是否存在</span></span>
<span class="line"><span>boolean exists = client.indices().exists(request, RequestOptions.DEFAULT);</span></span>
<span class="line"><span>// 3.输出</span></span>
<span class="line"><span>System.err.println(exists ? &quot;索引库已经存在！&quot; : &quot;索引库不存在！&quot;);</span></span></code></pre></div><h3 id="问题-怎么删除索引库-indices是操作数据库怎么样怎么样" tabindex="-1">问题：怎么删除索引库？ indices是操作数据库怎么样怎么样 <a class="header-anchor" href="#问题-怎么删除索引库-indices是操作数据库怎么样怎么样" aria-label="Permalink to “问题：怎么删除索引库？ indices是操作数据库怎么样怎么样”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 发送请求 </span></span>
<span class="line"><span>DeleteIndexRequest hotel = new DeleteIndexRequest(&quot;hotel&quot;);</span></span>
<span class="line"><span>        AcknowledgedResponse delete = client.indices().delete(hotel,RequestOptions.DEFAULT); //删除</span></span></code></pre></div><h3 id="问题-索引库有了-怎么添加文档呢" tabindex="-1">问题：索引库有了，怎么添加文档呢？ <a class="header-anchor" href="#问题-索引库有了-怎么添加文档呢" aria-label="Permalink to “问题：索引库有了，怎么添加文档呢？”">​</a></h3><p><img src="/assets/61.D0mRPkPQ.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>//这里我们新创建一个类</span></span>
<span class="line"><span>    @Autowired  //查询数据库</span></span>
<span class="line"><span>    private IHotelService hotelService;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>    private RestHighLevelClient client;</span></span>
<span class="line"><span>    @BeforeEach //方法执行前开启连接ES</span></span>
<span class="line"><span>    void initClient() {</span></span>
<span class="line"><span>        this.client = new RestHighLevelClient(RestClient.builder(</span></span>
<span class="line"><span>                HttpHost.create(&quot;http://192.168.136.130:9200&quot;)</span></span>
<span class="line"><span>        ));</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    @AfterEach //方法执行完后执行</span></span>
<span class="line"><span>    void closeClient() throws IOException {</span></span>
<span class="line"><span>        this.client.close(); //关闭ES</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	public void test(){</span></span>
<span class="line"><span>       //从MySQL数据库获取酒店数据</span></span>
<span class="line"><span>        Hotel byId = hotelService.getById(36934L);</span></span>
<span class="line"><span>        //把MySQL转为ES实体（这边是写了一个ES的一个构造方法）</span></span>
<span class="line"><span>        HotelDoc hotelDoc = new HotelDoc(byId);</span></span>
<span class="line"><span>        //然后把ES实体转换为JSon（因为ES存的都是json格式）</span></span>
<span class="line"><span>        String json = JSON.toJSONString(hotelDoc);</span></span>
<span class="line"><span>        //1 创建request连接，发送请求 （输入ES索引库名称，id是ES的id，因为要求id是字符串类型，所以toString转为字符串）</span></span>
<span class="line"><span>        IndexRequest hostl = new IndexRequest(&quot;hostl&quot;).id(hotelDoc.getId().toString());</span></span>
<span class="line"><span>        //2 准备要存储的数据 DSL  然后指定要存储的数据类型</span></span>
<span class="line"><span>        hostl.source(json, XContentType.JSON);</span></span>
<span class="line"><span>        //3 发送请求   后面这个是告诉ES我传的的格式是默认的格式</span></span>
<span class="line"><span>        client.index(hostl, RequestOptions.DEFAULT);</span></span>
<span class="line"><span>    }</span></span></code></pre></div><h3 id="问题-怎么查看文档" tabindex="-1">问题：怎么查看文档？ <a class="header-anchor" href="#问题-怎么查看文档" aria-label="Permalink to “问题：怎么查看文档？”">​</a></h3><p><img src="/assets/62.D-QPeNNo.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>//创建请求对象（输入索引库名称和查询的id）</span></span>
<span class="line"><span>GetRequest hotel = new GetRequest(&quot;hotel&quot;, &quot;369341&quot;);</span></span>
<span class="line"><span>//发送请求，得到结果  response就是得到的ES的原始结构</span></span>
<span class="line"><span>GetResponse response = client.get(hotel, RequestOptions.DEFAULT);</span></span>
<span class="line"><span>//解析结果，通过方法getSourceAsString得到json字符串</span></span>
<span class="line"><span>String json = response.getSourceAsString();</span></span>
<span class="line"><span>System.out.println(json); //json格式的文档</span></span>
<span class="line"><span>//json转成java格式（通过方法SON.parseObject把json转为java对象）</span></span>
<span class="line"><span>HotelDoc hotelDoc = JSON.parseObject(json, HotelDoc.class);</span></span>
<span class="line"><span>System.out.println(hotelDoc);//java格式的文档</span></span></code></pre></div><p>因为全部修改就是新增覆盖，所以和新增一样。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>//创建请求对象 ，传入要修改的id</span></span>
<span class="line"><span> UpdateRequest request = new UpdateRequest(&quot;hotel&quot;, &quot;369341&quot;);</span></span>
<span class="line"><span> //输入要修改的参数</span></span>
<span class="line"><span> request.doc(&quot;age&quot;,100,&quot;name&quot;,&quot;我的新名字&quot;);</span></span>
<span class="line"><span> //发送请求，更新文档</span></span>
<span class="line"><span> client.update(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h3 id="问题-怎么删除文档" tabindex="-1">问题：怎么删除文档？ <a class="header-anchor" href="#问题-怎么删除文档" aria-label="Permalink to “问题：怎么删除文档？”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>//创建请求对象，输入要删除的id</span></span>
<span class="line"><span>DeleteRequest request = new DeleteRequest(&quot;hotel&quot;, &quot;369341&quot;);</span></span>
<span class="line"><span>//发送请求，删除文档</span></span>
<span class="line"><span>client.delete(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h3 id="问题-上面都是一个一个添加文档-怎么批量处理文档呢" tabindex="-1">问题：上面都是一个一个添加文档，怎么批量处理文档呢？ <a class="header-anchor" href="#问题-上面都是一个一个添加文档-怎么批量处理文档呢" aria-label="Permalink to “问题：上面都是一个一个添加文档，怎么批量处理文档呢？”">​</a></h3><p>这里拿批量添加来举例，我们可以用BulkRequest</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>//获取mysql所有数据</span></span>
<span class="line"><span> List&lt;Hotel&gt; list = hotelService.list();</span></span>
<span class="line"><span> //创建批量BulkRequest对象</span></span>
<span class="line"><span> BulkRequest request = new BulkRequest();</span></span>
<span class="line"><span> //用for循环取出所有的数据</span></span>
<span class="line"><span> for (Hotel hotel : list) {</span></span>
<span class="line"><span>  //把获取到的所有Mysql对象转换为ES实体</span></span>
<span class="line"><span>  HotelDoc hotelDoc = new HotelDoc(hotel);</span></span>
<span class="line"><span>  //把ES实体转换为json</span></span>
<span class="line"><span>  String jsonString = JSON.toJSONString(hotelDoc);</span></span>
<span class="line"><span>  //把对象都批量存储到BulkRequest对象中</span></span>
<span class="line"><span>  request.add(new IndexRequest(&quot;hostl&quot;).id(hotelDoc.getId().toString()).source(jsonString, XContentType.JSON));</span></span>
<span class="line"><span>       }</span></span>
<span class="line"><span>  //统一发送请求</span></span>
<span class="line"><span>  client.bulk(request, RequestOptions.DEFAULT);</span></span></code></pre></div><h3 id="es有了数据库了-怎么查询呢" tabindex="-1">ES有了数据库了，怎么查询呢？ <a class="header-anchor" href="#es有了数据库了-怎么查询呢" aria-label="Permalink to “ES有了数据库了，怎么查询呢？”">​</a></h3><p>常见的查询类型分为4类： <img src="/assets/63.B-ME8wZZ.png" alt=""> 第一个是查询所有数据用于测试： <img src="/assets/64.CVErSpkq.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># 查看全部数据</span></span>
<span class="line"><span>GET /索引库名/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;query&quot;: {</span></span>
<span class="line"><span>    &quot;match_all&quot;: {</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h4 id="全文检索查询" tabindex="-1">全文检索查询： <a class="header-anchor" href="#全文检索查询" aria-label="Permalink to “全文检索查询：”">​</a></h4><p>一般用于输入关键字查询，得到词条后会去倒排索引库匹配关键字，查询需要的文档，返回用户。</p><p>可以理解为你要去图书馆找一本书，要根据书的名字取对应的书架找需要的书。</p><p><strong>match查询：根据字段名查找</strong><img src="/assets/65.DA3yxyzB.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># 全文检索</span></span>
<span class="line"><span>GET /hotel/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;query&quot;: {</span></span>
<span class="line"><span>    &quot;match&quot;: {</span></span>
<span class="line"><span>      &quot;字段名&quot;: &quot;对应的名称&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>multi_match查询：与match查询类似，只不过允许同时查询多个字段。</strong><img src="/assets/66.CSYxd3PA.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># 全文检索多个</span></span>
<span class="line"><span>GET /hotel/_search</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;query&quot;: {</span></span>
<span class="line"><span>    &quot;multi_match&quot;: {</span></span>
<span class="line"><span>      &quot;query&quot;: &quot;如家&quot;,</span></span>
<span class="line"><span>      &quot;fields&quot;: [&quot;地址&quot;,&quot;城市&quot;,&quot;品牌&quot;]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>两个查询效果一样，有什么区别呢？</strong> match查询只是根据字段就能查出所有，而multi_match是根据多个字段查询，虽然比较精确，但查询的也多，对查询性能也大，所以建议使用单字段查询方式</p><h3 id="logstash" tabindex="-1">Logstash <a class="header-anchor" href="#logstash" aria-label="Permalink to “Logstash”">​</a></h3><p><img src="/assets/67.BWrhE2Bz.png" alt=""></p></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/java/springTask.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>SpringTask</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/java/dt.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>分布式事务</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-1df9f90f data-v-c3855bb3><div class="container" data-v-c3855bb3><p class="message" data-v-c3855bb3><img src="/images/03.png" alt="Logo" style="height: 180px; vertical-align: middle; margin-right: 8px;"> hello world</p><p class="copyright" data-v-c3855bb3>© 2025 本博客已省略 9999 个 bug</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"admin_my.md\":\"BBDaMPgD\",\"dev_docker.md\":\"CZ1Ows3t\",\"dev_mysql.md\":\"B9i0tOVS\",\"dev_nginx.md\":\"BYrY6LqE\",\"dev_redis.md\":\"8QFZQHWt\",\"index.md\":\"C8ZZ54zT\",\"java_bitmap.md\":\"Da1EIbqE\",\"java_dt.md\":\"B9oHvMn7\",\"java_es.md\":\"CbGsdVa3\",\"java_index.md\":\"B8trZM9W\",\"java_java.md\":\"D0bYkbBw\",\"java_mp.md\":\"D77jeMbt\",\"java_mq.md\":\"6nIMkIhz\",\"java_mqtt.md\":\"CBxS-T0R\",\"java_mybatis.md\":\"cx4fa_tH\",\"java_opensource.md\":\"B_KSq-C7\",\"java_project.md\":\"Dl41NjUO\",\"java_spring.md\":\"BYI60RGT\",\"java_springcache.md\":\"DLKoybBt\",\"java_springcloud.md\":\"CIOOmLFk\",\"java_springtask.md\":\"ctM-9Lty\",\"java_websocket.md\":\"N6rrX5BY\",\"linux_index.md\":\"CxIpGxZX\",\"linux_linux.md\":\"Bs0mqmQI\",\"utils_ai.md\":\"DV0BtycB\",\"utils_index.md\":\"0vgYDxqf\",\"utils_movie.md\":\"bltkneiK\",\"utils_pdl.md\":\"u3a8y3Ew\",\"utils_util.md\":\"BDGzHmF7\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"我的博客\",\"description\":\"德智体美劳全面发展\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"关于\",\"link\":\"/admin/my\"},{\"text\":\"潘多拉\",\"link\":\"/utils/index\"},{\"text\":\"Java\",\"link\":\"/java/index\"},{\"text\":\"Linux\",\"link\":\"/linux/index\"},{\"text\":\"组件\",\"items\":[{\"text\":\"MySql\",\"link\":\"/dev/mysql\"},{\"text\":\"Nginx\",\"link\":\"/dev/nginx\"},{\"text\":\"Redis\",\"link\":\"/dev/redis\"},{\"text\":\"Docker\",\"link\":\"/dev/docker\"}]}],\"search\":{\"provider\":\"local\"},\"outlineTitle\":\"页面导航\",\"footer\":{\"message\":\"<img src=\\\"/images/03.png\\\" alt=\\\"Logo\\\" style=\\\"height: 180px; vertical-align: middle; margin-right: 8px;\\\"> hello world\",\"copyright\":\"© 2025 本博客已省略 9999 个 bug\"},\"sidebar\":{\"/\":[],\"/utils/\":[{\"text\":\"概览\",\"collapsible\":true,\"collapsed\":false,\"items\":[{\"text\":\"Ai\",\"link\":\"/utils/ai\"},{\"text\":\"影视\",\"link\":\"/utils/movie\"},{\"text\":\"工具\",\"link\":\"/utils/util\"},{\"text\":\"潘多拉\",\"link\":\"/utils/pdl\"}]}],\"/java/\":[{\"text\":\"概览\",\"collapsible\":true,\"collapsed\":false,\"items\":[{\"text\":\"Java基础\",\"link\":\"/java/java\"},{\"text\":\"开源框架\",\"link\":\"/java/openSource\"},{\"text\":\"MybatisPlus\",\"link\":\"/java/mp\"},{\"text\":\"SpringCloud\",\"link\":\"/java/springCloud\"},{\"text\":\"WebSocket\",\"link\":\"/java/webSocket\"},{\"text\":\"SpringCache\",\"link\":\"/java/springCache.md\"},{\"text\":\"位图\",\"link\":\"/java/bitmap\"},{\"text\":\"Spring\",\"link\":\"/java/spring\"},{\"text\":\"MQTT\",\"link\":\"/java/mqtt\"},{\"text\":\"SpringTask\",\"link\":\"/java/springTask\"},{\"text\":\"ES\",\"link\":\"/java/es\"},{\"text\":\"分布式事务\",\"link\":\"/java/dt\"},{\"text\":\"Java项目\",\"link\":\"/java/project\"},{\"text\":\"MQ\",\"link\":\"/java/mq\"},{\"text\":\"Mybatis\",\"link\":\"/java/mybatis\"}]}],\"/linux/\":[{\"text\":\"Linux基础\",\"collapsible\":true,\"collapsed\":false,\"items\":[{\"text\":\"常用命令\",\"link\":\"/linux/commands\"},{\"text\":\"文件系统\",\"link\":\"/linux/filesystem\"},{\"text\":\"权限管理\",\"link\":\"/linux/permissions\"}]},{\"text\":\"Linux高级\",\"collapsible\":true,\"collapsed\":false,\"items\":[{\"text\":\"Shell脚本\",\"link\":\"/linux/shell\"},{\"text\":\"系统管理\",\"link\":\"/linux/administration\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>